!(function (m) {
    xsLocalStorage.init({ iframeUrl: exad_cross_site.exad_cross_site_api, initCallback: function () {} });
    var i = ["exad", "exad_column", "exad_section", "exad_container"],
        n = ["widget", "column", "section", "container"];
    (Exad_Cross_Site_Manager = {
        paste: function (e, t) {
            var n = null,
                i = { index: 0 },
                a = e.widgetCode,
                o = JSON.stringify(a),
                r = a.elType,
                s = /\.(jpg|png|jpeg|gif|svg)/gi.test(o),
                d = { elType: r, settings: a.settings },
                c = t,
                l = t.model.get("elType");
            switch (r) {
				case "container":
                case "section":
                    switch (((d.elements = Exad_Cross_Site_Manager.generateUniqueID(a.elements)), (n = elementor.getPreviewContainer()), l)) {
                        case "widget":
                            i.index = c.getContainer().parent.parent.view.getOption("_index") + 1;
                            break;
                        case "column":
                            i.index = c.getContainer().parent.view.getOption("_index") + 1;
                            break;
                        case "section":
							i.index = c.getOption("_index") + 1;
							break;
                        case "container":
                            i.index = c.getContainer().view.getOption("_index") + 1;
                    }
                    break;
                case "column":
                    switch (((d.elements = Exad_Cross_Site_Manager.generateUniqueID(a.elements)), l)) {
                        case "widget":
                            (n = c.getContainer().parent.parent), (i.index = c.getContainer().parent.view.getOption("_index") + 1);
                            break;
                        case "column":
                            (n = c.getContainer().parent), (i.index = c.getOption("_index") + 1);
                            break;
                        case "section":
							n = c.getContainer();
						case "container":
                            n = false;
                    }
                    break;
                case "widget":
                    switch (((d.widgetType = a.widgetType), (n = c.getContainer()), l)) {
                        case "widget":
                            (n = c.getContainer().parent), (i.index = c.getOption("_index") + 1);
                            break;
                        case "column":
                            n = c.getContainer();
                            break;
                        case "section":
							n = c.children.findByIndex(0).getContainer();
							break;
						case "container":
							n = c.getContainer();
                    }
            }
			
			if ( n === false ) {
				
				return false;
			}
			
            var g = $e.run("document/elements/create", { model: d, container: n, options: i });
            null == g &&
                ("widget" === l
                    ? c.$el.next(".undefined.elementor-widget-empty") && c.$el.next(".undefined.elementor-widget-empty").after('<div class="elementor-alert elementor-alert-warning">' + exad_cross_site.exad_widget_not_found + "</div>")
                    : c.$el.find(".undefined.elementor-widget-empty") && c.$el.find(".undefined.elementor-widget-empty").after('<div class="elementor-alert elementor-alert-warning">' + exad_cross_site.exad_widget_not_found + "</div>")),
                s &&
                    m
                        .ajax({
                            url: exad_cross_site.ajaxURL,
                            method: "POST",
                            data: { nonce: exad_cross_site.cscp_nonce, action: "exad_process_import", content: o },
                            beforeSend: function () {
                                g.view.$el.addClass("exad-processing-import");
                            },
                        })
                        .done(function (e) {
                            if (e.success) {
                                var t = e.data[0];
                                (d.elType = t.elType),
                                    (d.settings = t.settings),
                                    "widget" === d.elType ? (d.widgetType = t.widgetType) : (d.elements = t.elements),
                                    $e.run("document/elements/delete", { container: g }),
                                    $e.run("document/elements/create", { model: d, container: n, options: i });
                            }
                        });
        },
        generateUniqueID: function (e) {
            return (
                e.forEach(function (e, t) {
                    void 0 !== elementorCommon.helpers.getUniqueId() ? (e.id = elementorCommon.helpers.getUniqueId()) : (e.id = elementor.helpers.getUniqueID()), 0 < e.elements.length && Exad_Cross_Site_Manager.generateUniqueID(e.elements);
                }),
                e
            );
        },
    }),
        i.forEach(function (e, t) {
            elementor.hooks.addFilter("elements/" + n[t] + "/contextMenuGroups", function (e, n) {
                return (
                    e.push({
                        name: i[t],
                        actions: [
                            {
                                name: "copy",
                                title: exad_cross_site.exad_copy,
                                callback: function () {
                                    var e = { widgetType: n.model.get("widgetType"), widgetCode: n.model.toJSON() };
                                    xsLocalStorage.setItem("exad_container_new", JSON.stringify(e));
                                },
                            },
                            {
                                name: "paste",
                                title: exad_cross_site.exad_paste,
                                callback: function () {
                                    var t = "";
                                    xsLocalStorage.getItem("exad_container_new", function (e) {
                                        (t = JSON.parse(e.value)), Exad_Cross_Site_Manager.paste(t, n);
                                    });
                                },
                            },
                        ],
                    }),
                    e
                );
            });
        });
})(jQuery);
